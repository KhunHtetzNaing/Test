package com.mycompany.myapp;

import android.app.*;

import android.os.*;

import org.jsoup.nodes.*;

import org.jsoup.*;

import java.io.*;

import org.jsoup.select.*;

import org.json.*;

import android.content.*;

public class MainActivity extends Activity 

{

    @Override

    protected void onCreate(Bundle savedInstanceState)

    {

        super.onCreate(savedInstanceState);

        setContentView(R.layout.main);

		Fuck f = new Fuck();		f.execute();

	}

	

	public class Fuck extends AsyncTask<Void,Void,String>

	{

		@Override

		protected String doInBackground(Void[] p1)

		{

			String result = null;

			try

			{

				Document doc = Jsoup.connect("https://www.instagram.com/p/BjvOHfxhkPg/").get();

			Elements ele = doc.select("script");

			for(int i=0;i<ele.size();i++){

				String s = ele.get(i).data();

				if(s.contains("window._sharedData")==true){

					result = s;

					break;

				}

			}

			

				result=result.replace("window._sharedData = ","");

				result=result.replace(";","");

				try

				{

					String isVideo = "This is Photo: ";

					JSONObject jSONObject = new JSONObject(new JSONObject(new JSONArray(new JSONObject(new JSONObject(result).getString("entry_data")).getString("PostPage")).getJSONObject(0).getString("graphql")).getString("shortcode_media"));

					String string2 = jSONObject.getString("display_url");

					if (jSONObject.getBoolean("is_video")){

						isVideo = "This is Video: ";

						string2 = jSONObject.getString("video_url");

					}

					result=isVideo+string2;

				}

				catch (JSONException e)

				{}

			}

			catch (IOException e)

			{}

			return result;

		}

		@Override

		protected void onPostExecute(final String result)

		{

			// TODO: Implement this method

			super.onPostExecute(result);

			runOnUiThread(new Runnable() {

					public void run() {

						AlertDialog.Builder b = new AlertDialog.Builder(MainActivity.this)

							.setTitle("test")

							.setMessage(result);

						AlertDialog d = b.create();

						d.show();

						ClipboardManager clip =(ClipboardManager) getSystemService(CLIPBOARD_SERVICE);

					clip.setText(result);

						}

				});

			

		}

		

	}

}
